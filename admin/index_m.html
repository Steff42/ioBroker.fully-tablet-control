<html>

<head>
    <!-- Load ioBroker scripts and styles-->
    <link rel="stylesheet" type="text/css" href="../../css/adapter.css" />
    <link rel="stylesheet" type="text/css" href="../../lib/css/materialize.css">

    <script type="text/javascript" src="../../lib/js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="../../socket.io/socket.io.js"></script>

    <script type="text/javascript" src="../../js/translate.js"></script>
    <script type="text/javascript" src="../../lib/js/materialize.js"></script>
    <script type="text/javascript" src="../../js/adapter-settings.js"></script>

    <!-- Load our own files -->
    <script type="text/javascript" src="words.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />


    <!-- you have to define 2 functions in the global scope: -->
    <script type="text/javascript">

        // /**
        //  * Fill table with data from array
        //  * @param {string} id - The id of the table as string, e.g. #table-id
        //  * @param {array} data - The data for the row, in the order of the columns
        //  * @param {boolean} delBtn - If true a delete button is added. This button will only delete the displayed row data, you have to add additional functions by yourself.
        //  */
        // function fillTable(id, data, delBtn) {
        //     let tableRow;

        //     for (let d in data) {
        //         const index = d;
        //         let col = $(id + ' > table > thead > tr').children().eq(index);
        //         let write = $(col).attr('data-write');  //Look at the table head for column if it should be a input field
        //         let type = $(col).attr('data-type');    //Look for the type of data, only relevant if data-write is true

        //         switch (type) {
        //             case 'number':
        //                 if (write === 'true') {
        //                     tableRow += `<td><input type="number" class="validate" value="${data[d]}"></td>`;
        //                 } else {
        //                     tableRow += `<td>${data[d]}</td>`
        //                 }
        //                 break;
        //             case 'text':
        //                 if (write === 'true') {
        //                     tableRow += `<td><input type="text" class="validate" value="${data[d]}"></td>`;
        //                 } else {
        //                     tableRow += `<td>${data[d]}</td>`
        //                 }
        //                 break;
        //             case 'password':
        //                 if (write === 'true') {
        //                     tableRow += `<td><input type="password" class="validate" value="${data[d]}"></td>`;
        //                 } else {
        //                     tableRow += `<td>${data[d]}</td>`
        //                 }
        //                 break;
        //             case 'ip':
        //                 if (write === 'true') {
        //                     tableRow += `<td><input type="ip" class="validate" value="${data[d]}"></td>`;
        //                 } else {
        //                     tableRow += `<td>${data[d]}</td>`
        //                 }
        //                 break;
        //             case 'checkbox':
        //                 if (write === 'true') {
        //                     tableRow += `<td><input type="checkbox" class="validate" value="${data[d]}"></td>`;
        //                 } else {
        //                     tableRow += `<td>${data[d]}</td>`
        //                 }
        //                 case 'select':
        //                 if (write === 'true') {
        //                     tableRow += `<td><input type="select" class="validate" value="${data[d]}"></td>`;
        //                 } else {
        //                     tableRow += `<td>${data[d]}</td>`
        //                 }

        //         }
        //     }

        //     if (delBtn === true) {
        //         $('.delete-table-row').unbind('click');     //unbind event listener for buttons with class delete-table-row to prevent multiple function calls
        //         tableRow += `<td><a class="delete-table-row btn-floating btn-small waves-effect waves-light red"><i class="material-icons">delete</i></a></td>`;
        //     }

        //     tableRow = `<tr> ${tableRow} </tr>`;
        //     $(id + ' > table > tbody').append(tableRow);

        //     $('.delete-table-row').on('click', (event) => {
        //         console.log('delete');
        //         $(event.currentTarget).parentsUntil('tr').parent().remove();

        //         //additional functions that will be called when delete button was clicked
        //     })

        //     M.updateTextFields();
        // }

        // /**
        //  * This will be called by the admin adapter when the settings page loads
        //  * @param {object} settings - represents the adapter config object
        //  * @param {object} onChange - callback
        //  */
        // function load(settings, onChange) {
        //     if (!settings) return;

        //     //  example: select elements with id=key and class=value
        //     $('.value').each(function () {
        //         var $key = $(this);
        //         var id = $key.attr('id');
        //         // check which type of html element
        //         if ($key.attr('type') === 'checkbox') {
        //             $key.prop('checked', settings[id])  // read setting value from adapter config object and set checkbox in config page
        //                 .on('change', () => onChange()) // set listener to checkbox and call onChange if the value has changed
        //                 ;
        //         } else {
        //             $key.val(settings[id])
        //                 .on('change', () => onChange())
        //                 .on('keyup', () => onChange())
        //                 ;
        //         }
        //     });

        //     onChange(false);

        //     //fill dynamic table
        //     $('#fill-motion-table').on('click', () => {
        //        let data = ['',''];
        //         fillTable('#motion-table', data, true);

        //     })
        //     $('#fill-telegram-table').on('click', () => {
        //        let data = [''];
        //         fillTable('#telegram-table', data, true);

        //     })
        //     $('#fill-devices-table').on('click', () => {
        //        let data = ['','','2323',''];
        //         fillTable('#devices-table', data, true);

        //     })
        //     $('#fill-charger-table').on('click', () => {
        //        let data = ['',''];
        //         fillTable('#charger-table', data, true);

        //     })
        //     // reinitialize all the Materialize labels on the page if you are dynamically adding inputs:
        //     if (M) M.updateTextFields();

        //     //initialize dropdowns
        //     $('.dropdown-trigger').dropdown();
        // }


        // /**
        //  * This will be called by the admin adapter when the user presses the Save or Save and Close button
        //  * @param {object} callback - JSON object which holds keys and their values that will be written to adapter config object
        //  */
        // function save(callback) {

        //     // example: select elements with class=value and build settings object
        //     var obj = {};
        //     $('.value').each(function () {
        //         var $this = $(this);
        //         if ($this.attr('type') === 'checkbox') {
        //             obj[$this.attr('id')] = $this.prop('checked');
        //         } else {
        //             obj[$this.attr('id')] = $this.val();
        //         }
        //     });
        //     callback(obj);
        // }


        var user = [];
        var devices = [];
        var telegram = [];
        var motion = [];
        var charger = [];
        // the function loadSettings has to exist ...
        function load(settings, onChange) {
            if (!settings) return;
            for (var key in settings) {
                if (!settings.hasOwnProperty(key)) continue;
                var $value = $('#' + key + '.value');
                if ($value.attr('type') === 'checkbox') {
                    $value.prop('checked', settings[key]).on('change', function () {
                        if ($('#auth').prop('checked')) {
                            $('#secure').prop('checked', true);
                        }
                        onChange();
                        showHideSettings();
                    });
                } else {
                    $value.val(settings[key]).on('change', function () {
                        onChange();
                    }).keyup(function () {
                        onChange();
                    });
                }
            }
            user = settings.user || [];
            devices = settings.devices || [];
            telegram = settings.telegram || [];
            motion = settings.motion || [];
            charger = settings.charger || [];
            onChange(false);

            values2table('devices', devices, onChange);
            values2table('user', user, onChange);
            values2table('telegram', telegram, onChange);
            values2table('motion', motion, onChange);
            values2table('charger', charger, onChange);
        }
        // ... and the function save has to exist.
        // you have to make sure the callback is called with the settings object as first param!
        function save(callback) {
            var obj = {};
            $('.value').each(function () {
                var $this = $(this);
                if ($this.attr('type') === 'checkbox') {
                    obj[$this.attr('id')] = $this.prop('checked');
                } else {
                    obj[$this.attr('id')] = $this.val();
                }
            });

            obj.devices = table2values('devices');
            obj.user = table2values('user');
            obj.telegram = table2values('telegram');
            obj.motion = table2values('motion');
            obj.charger = table2values('charger');
            callback(obj);
        }

    </script>

</head>

<body>
    <!-- you have to put your config page in a div with id adapter-container -->
    <div class="m adapter-container">
        <div class="row">

            <!-- Tabs: Menu -->
            <div class="col s12">
                <ul class="tabs">
                    <!-- Single tab entry -->
                    <li class="tab col s1.1"><a href="#tab-main" class="translate active">Main settings</a></li>
                    <li class="tab col s1.1"><a href="#tab-devices" class="translate">fully browser</a></li>
                    <li class="tab col s1.1"><a href="#tab-telegram" class="translate">telegram</a></li>
                    <li class="tab col s1.1"><a href="#tab-motion" class="translate">motion detector</a></li>
                    <li class="tab col s1.1"><a href="#tab-charger" class="translate">charger</a></li>
                </ul>
            </div>
            <!-- Tabs: Menu -->


            <!-- Tab with id "tab-main" -->
            <div id="tab-main" class="col s12 ">
                <div class="row">
                    <div class="col s12 m4 l2">
                        <img src="tablet-control.png" width="80" height="80">
                        <img class="logo">
                    </div>
                </div>
                <!-- polling interval section -->
                <div class="section">

                    <div class="row">

                        <div class="col s12">
                            <h6 class="translate sub-title">polling interval</h6>
                        </div>
                    </div>

                    <div class="col s6 input-field">
                        <input type="number" class="value" id="interval" style="width:20%; text-align: center" max="3600" min="0"
                            value="30" />
                        <label for="interval" class="translate">interval</label>
                    </div>
                </div>
            </div>
            <!-- polling interval section -->


            <!-- Tab with id "tab-devices" -->
            <div id="tab-devices" class="col s12 page">
                <div class="row"></div>
                    <div class="col s12" id="devices">
                        <div class="row">
                            <a class="waves-effect waves-light btn table-button-add">add Device</a>
                        </div>
                        <!-- fully browser login table -->
                        <div class="table-values-div">
                            <table class="table-values">
                                <thead>
                                    <tr>
                                        <th class="translate" style="width: auto; text-align: center;" data-style="text-align: center" data-name="name">name</th>
                                        <th class="translate" value="2323" style="width: auto; text-align: center;" data-style="text-align: center" data-name="ip">ip</th>
                                        <th class="translate" data-type="number" data-default="2323" data-style="text-align: center" style="width: 5%; text-align: center;"
                                            data-name="port">port</th>
                                        <th class="translate" style="width: auto; text-align: center;" data-style="text-align: center" data-name="password"
                                            data-type="password">password</th>
                                            <th class="translate"  style="width: 15%; text-align: center;" data-type="select"
                                            data-name="room">room</th>
                                            <th class="translate" style="width: 5%; text-align: center;" 
                                            data-buttons="delete up down">delete</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <!-- fully browser table -->
                    </div>
            </div>
            <!-- Tab with id "tab-devices" -->

            <!-- Tab with id "tab-telegram"-->
            <div id="tab-telegram" class="col s12">
                <div class="row">
                    <!-- select telegram active -->
                    <div class="input-field col s3">
                        <select autofocus="autofocus" required="required" value=false id="telegramAktive">
                            <option class="translate" value="true" selected>Warning activated</option>
                            <option class="translate" value="false" selected>Warning deactivated</option>
                        </select>
                        <label for="telegramAktive" class="translate" style="color: #000000">telegram-aktive</label>
                    </div>
                    <!-- telegram active active -->
            
                    <!-- telegram table -->
            
                    <div class="col s12" id="telegram">
                        <div class="row center">
                            <a class="waves-effect waves-light btn table-button-add">add Device</a>
                        </div>
                        <!-- motion table -->
                        <div class="table-values-div">
                            <table class="table-values">
                                <thead>
                                    <tr>
                                        <th class="translate" data-style="text-align: center" style="width: auto; text-align: center;" 
                                            data-name="telegramUser">telegramUser</th>
                                        <th class="translate" style="width: 1%; text-align: center;" 
                                            data-buttons="delete up down">delete</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <!-- motion table -->
                    </div>
            
            
                </div>
            </div>
                <!-- telegram table -->
            
            
                <!-- Tab with id "tab-motion" -->
                <div id="tab-motion" class="col s12">
                    <div class="row"></div>
                    <div class="col s12" id="motion">
            
                        <div class="row">
                            <a class="waves-effect waves-light btn table-button-add">add Device</a>
                        </div>
                        <!-- motion table -->
                        <div class="table-values-div">
                            <table class="table-values">
                                <thead>
                                    <tr>
                                        <th class="translate" data-style="text-align: center" style="width: auto; text-align: center;" 
                                            data-name="motionid">motionId</th>
                                            <th class="translate"  style="width: 15%; text-align: center;" data-type="select"
                                            data-name="room">room</th>
                                        <th class="translate " style="width: 1%; text-align: center;" data-type="checkbox"
                                            data-name="active">active</th>
                                        <th class="translate" style="width: 1%; text-align: center;" 
                                            data-buttons="delete up down">delete</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <!-- motion table -->
                    </div>
                </div>
                <!-- Tab with id "tab-devices" -->
            
                <!-- Tab with id "tab-charger" -->
                <div id="tab-charger" class="col s12">
                    <div class="row">
                        <!-- select  -->
                        <div class="input-field col s3">
                            <select autofocus="autofocus" required="required" value=false id="power_mode">
                                <option class="translate" value="true" selected>Charge cycle</option>
                                <option class="translate" value="false" selected>Continuous current</option>
                            </select>
                            <label for="power_mode" class="translate" style="color: #000000">power_mode</label>
                        </div>
            
                        <!-- charger table -->
                        <div class="col s12" id="charger">
                            <div class="row center">
                                <!-- motion table -->
                                <a class="waves-effect waves-light btn table-button-add">add Device</a>
                            </div>
                            <div class="table-values-div">
                                <table class="table-values">
                                    <thead>
                                        <tr>
                                            <th class="translate" data-style="text-align: center" style="width: 50px; text-align: center;" data-name="motionid">
                                                chargerid</th>
                                            <th class="translate"  style="width: 15%; text-align: center;" data-type="select"
                                                data-name="room">room</th>
                                            <th class="translate" style="width: 1%; text-align: center;"
                                                data-buttons="delete up down">delete</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- charger table -->
                </div>
        </div> <!-- Tab with id "tab-devices" -->
            
    </div>
            
</body>
            
</html>